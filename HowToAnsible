#lemp
vagrant status
vagrant init ubuntu/focal64
vagrant up
vagrant status
vagrant ssh default
vagrant destroy


#+NGINX
sudo apt -y update
sudo apt install -y nginx
cd "/c/Users/Pavel/OneDrive/SLURM/Ansible/ansible_course/1.lemp/one-page_site"
Vagrant upload .\index_files /var/www/html/index_files
Vagrant upload index.html /var/www/html/index.html

#+MYSQL

sudo apt install -y mysql-server
sudo systemctl --type=service
sudo mysql_secure_installation
sydo mysql
 SELECT user, plugin FROM mysql.user;
 ALTER USER 'root'@'localhost' IDENTIFIED WITH 'mysql_native_password' BY 'password';

 #+PHP at port 81:8081
sudo apt install -y php-fpm php-mysql
php --version
ls -la /var/run/php/
sudo vim /etc/nginx/sites-available/php_test.conf
sudo ln -s /etc/nginx/sites-available/php_test.conf /etc/nginx/sites-enabled/php_test
ls -la /etc/nginx/sites-enabled/
sudo nginx -t
sudo nginx -s reload
cd /var/www/
sudo mkdir php_test
sudo chown vagrant:vagrant php_test
cd php_test/
vim index.php
127.0.0.1 php-test.com to hosts file

vagrant upload .\test-connection.php /var/www/php_test/
curl "php-test.com:8081/test-connection.php"


#2.lemp-ansble

vagrant ssh controlnode
sudo apt-add-repository ppa:ansible/ansible
sudo apt install -y ansible sshpass
ansible --version
#create hosts.ini file so it will appear in /home/vagrant/ansible
#нужно ssh-нуться почему-то на таргет из списка хостов для сохранения отпечатка.
ansible all -i hosts.ini -m ping --ask-pass



практика 3.10
запускаю оба коннечусь
ssh s065818@sbox.slurm.io
eca7b5f5
ssh node-1.s065818
ssh node-2.s065818
sudo -i


#git preparation
ssh-keygen -t rsa -b 4096 -C "paveldtsn@gmail.com" -f ~/.ssh/homie_vscode_github
ssh-add ~/.ssh/homie_vscode_github
ssh -T git@github.com

git config --global user.email "paveldtsn@gmail.com"
git config --global user.name "paveldtsn"



#теория 3.other
новый фолдер новый vagrant



#настоящая практика
ssh -i "C:\Users\Pavel\.ssh\slurm_ssh_key" root@45.76.80.228 
#centos 7
ssh -i "C:\Users\Pavel\.ssh\slurm_ssh_key" root@45.76.95.174 
#centos 9
#создать vagrant пользователя и судо
useradd -m -s /bin/bash vagrant
passwd vagrant
echo "vagrant ALL=(ALL) NOPASSWD:ALL" | sudo EDITOR='tee -a' visudo
gem install bundler -v 1.16.2
gem install nokogiri -v '1.8.2'

sed -i 's/ChallengeResponseAuthentication no/ChallengeResponseAuthentication yes/#g' /etc/ssh/sshd_config
sudo apt update -y && sudo apt full-upgrade -y
sudo apt-add-repository ppa:ansible/ansible
sudo apt install -y ansible sshpass python3
ansible --version
#create hosts.ini file so it will appear in /home/vagrant/ansible
#нужно ssh-нуться почему-то на таргет из списка хостов для сохранения отпечатка.
ansible all -i hosts.ini -m ping --ask-pass

#На контрол ноде создать новюу роль 
ansible-galaxy init dependencies
